<div id="browse_map" class='clearfix content_map'>
  <% if map.instance_of? Changeset or map.instance_of? Array or (map.instance_of? Node and map.version > 1) or map.visible %>

  <% content_for :head do %>
    <%= javascript_include_tag "browse" %>
  <% end %>

  <%
     if map.instance_of? Changeset
       bbox = map.bbox.to_unscaled
       data = {
         :type   => "changeset",
         :id     => map.id,
         :minlon => bbox.min_lon,
         :minlat => bbox.min_lat,
         :maxlon => bbox.max_lon,
         :maxlat => bbox.max_lat
       }
     elsif map.instance_of? Array
       data = {
         :type => "objects",
         :objects => Array.new
       }
       for object in map do
         data[:objects].push( { 
           :type => object.class.name.downcase,
           :id => object.id,
           :version => object.version,
           :visible => object.visible
           } )
       end
     else
       data = {
         :type    => map.class.name.downcase,
         :id      => map.id,
         :version => map.version,
         :visible => map.visible
       }
     end
  %>
  <%= content_tag "div", "", :id => "small_map", :data => data %>
  <span id="loading"><%= t 'browse.map.loading' %></span>

  <% else %>
    <%= t 'browse.map.deleted' %>
  <% end %>
</div>
